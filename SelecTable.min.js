/*
 The MIT License (MIT)
 Copyright (c) 2014 c0ff3m4r <l34k@bk.ru>
*/
function k(b,a){function d(a){a.stopPropagation();a=this.row;this.checked?f.select(a,!0):l(f,a)}var c,e,g,f=this;this.e={cssSelected:"selected",cssFocused:"focused",focusCheckbox:!0,allCheckbox:!1};this.a={};for(variable in this.e)this.a[variable]=a&&a.hasOwnProperty(variable)?a[variable]:this.e[variable];this.b=this.c=null;this.a.cssFocused&&(this.c=new RegExp("(?:^|\\s)"+this.a.cssFocused+"(?!\\S)","g"));this.a.cssSelected&&(this.b=new RegExp("(?:^|\\s)"+this.a.cssSelected+"(?!\\S)","g"));if("string"==
typeof b&&(b=document.getElementById(b),null===b))return;this.table=b;var h=b.tBodies[0].rows;this.selected=null;this.d=0;if(c=this.a.allCheckbox)"string"==typeof c&&(c=document.getElementById(this.a.allCheckbox)),c.onchange=function(){if(this.checked)for(var a=f,b=a.rows.length-1;0<=b;b--)a.select(a.rows[b],!0);else m(f)};for(e=0;e<h.length;e++){c=h[e].getElementsByTagName("input");h[e].checkbox=null;for(g=0;g<c.length;g++)if("checkbox"==c[g].type){c[g].onclick=d;c[g].checked&&this.select(e,!0);
c[g].row=h[e];h[e].checkbox=c[g];break}h[e].setAttribute("unselectable","on");h[e].onclick=function(a){var b;a||(a=event);if(1==a.ctrlKey)f.toggle(this);else if(1==a.shiftKey){if(b=f.f(),null!==b){var c=f,d,e=1;d=n(c,b);b=n(c,this);for(d>b&&(e=-1);d!=b;d+=e)c.select(d,!1);c.select(this,!0)}}else!f.rows[n(f,this)].checkbox.checked||1<f.d?(c=f,m(c),c.select(this)):m(f);1==a.shiftKey&&(window.getSelection?window.getSelection().empty?window.getSelection().empty():window.getSelection().removeAllRanges&&
window.getSelection().removeAllRanges():document.selection&&document.selection.empty())}}this.rows=h}k.prototype.select=function(b,a){"undefined"===typeof a&&(a=!0);var d=p(this,b),c=d.checkbox;a&&(this.c&&(null!=this.selected&&(this.selected.className=this.selected.className.replace(this.c,"")),d.className+=" "+this.a.cssFocused),this.selected=d,this.a.focusCheckbox&&c&&c.focus());this.b&&(d.className+=" "+this.a.cssSelected);c&&(c.checked||this.d++,c.checked=!0)};
function l(b,a){var d=p(b,a),c=d.checkbox;b.b&&(d.className=d.className.replace(b.b,""));c&&(c.checked&&b.d--,c.checked=!1)}k.prototype.toggle=function(b){b=p(this,b);b.checkbox.checked?l(this,b):this.select(b,!0)};function n(b,a){if("number"===typeof a)return a;if(!a||"number"!==typeof a.nodeType&&3==a.nodeType)throw a;return a.rowIndex-b.table.tHead.rows.length}function p(b,a){if("number"===typeof a)return b.rows[a];if(!a||"number"!==typeof a.nodeType&&3==a.nodeType)throw a;return a}
k.prototype.f=function(){return this.selected};function m(b){for(var a=0;a<b.rows.length;a++)l(b,a)}window.SelecTable=k;window.SelecTable.prototype.getSelectedRow=k.prototype.f;